{"componentChunkName":"component---src-templates-blog-post-js","path":"/2019/07/bundling-adoptopenjdk-into-a-notarized-macos-application/","result":{"data":{"site":{"siteMetadata":{"title":"AdoptOpenJDK Blog","siteUrl":"https://blog.adoptopenjdk.net","social":{"twitter":"AdoptOpenJDK"}}},"mdx":{"id":"30a2b11c-1853-57f9-9650-7cb0b6cdf07e","excerpt":"Some changes have been made to the way we codesign our macOS binaries. \n codesign  verification of a hardened runtime Summary Apple has recently changed theâ€¦","body":"var _excluded = [\"components\"];\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\n/* @jsxRuntime classic */\n\n/* @jsx mdx */\nvar _frontmatter = {\n  \"title\": \"Bundling AdoptOpenJDK into a notarized macOS application\",\n  \"date\": \"2019-07-31T12:00:00+00:00\",\n  \"author\": \"georgeadams\",\n  \"description\": \"Some changes have been made to the way we codesign our macOS binaries.\",\n  \"featuredImage\": \"./terminal_codesign.png\",\n  \"tags\": [\"faq\"]\n};\nvar layoutProps = {\n  _frontmatter: _frontmatter\n};\nvar MDXLayout = \"wrapper\";\nreturn function MDXContent(_ref) {\n  var components = _ref.components,\n      props = _objectWithoutProperties(_ref, _excluded);\n\n  return mdx(MDXLayout, _extends({}, layoutProps, props, {\n    components: components,\n    mdxType: \"MDXLayout\"\n  }), mdx(\"p\", null, \"Some changes have been made to the way we codesign our macOS binaries.\"), mdx(\"p\", null, mdx(\"span\", {\n    parentName: \"p\",\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"590px\"\n    }\n  }, \"\\n      \", mdx(\"a\", {\n    parentName: \"span\",\n    \"className\": \"gatsby-resp-image-link\",\n    \"href\": \"/static/9513b6475928b9e60db2ff40d468acdf/7422e/terminal_codesign.png\",\n    \"style\": {\n      \"display\": \"block\"\n    },\n    \"target\": \"_blank\",\n    \"rel\": \"noopener\"\n  }, \"\\n    \", mdx(\"span\", {\n    parentName: \"a\",\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"50.67567567567568%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAIAAAA7N+mxAAAACXBIWXMAAAsTAAALEwEAmpwYAAABJ0lEQVQoz42Q/W6CMBTFeROnkW+yIQgTJBZKXRUCTJYIQjKzf3z/R9ixRjOcS/ZLc5Om99xzeqXT8dCd2rbvm6Zt20PX9XVdf/TH7vMLV5z9vtnt6rKoynJwqupdilJKEhYTEsdxmqae52maZui6rmm6YDwZj0ajJ8F4iLThfMPfKKXr9TpJEt/3wzBcLpevAsyazWbz+TwIAtu2FUVRfyBlWYYI51qWnPP0CsahRlGEpptGGSIxxmAIW3QvFgtY+QLLsvCsifCGYfxWnsV5nm+326IoMAWBYXWpiOo4zovAdV3TNGVZvhcnFMYU2yKEwBZ9MIHhrUMWKI+Q8izDzmCOb8MEfQ8TPhYTzlYpI2SFDWOxjuAvq3ux/mxNVXUimF6R/wECfgPuh3ewg6WZ5wAAAABJRU5ErkJggg==')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  }), \"\\n  \", mdx(\"img\", {\n    parentName: \"a\",\n    \"className\": \"gatsby-resp-image-image\",\n    \"alt\": \"Codesign verification of a hardened runtime\",\n    \"title\": \"Codesign verification of a hardened runtime\",\n    \"src\": \"/static/9513b6475928b9e60db2ff40d468acdf/fcda8/terminal_codesign.png\",\n    \"srcSet\": [\"/static/9513b6475928b9e60db2ff40d468acdf/12f09/terminal_codesign.png 148w\", \"/static/9513b6475928b9e60db2ff40d468acdf/e4a3f/terminal_codesign.png 295w\", \"/static/9513b6475928b9e60db2ff40d468acdf/fcda8/terminal_codesign.png 590w\", \"/static/9513b6475928b9e60db2ff40d468acdf/7422e/terminal_codesign.png 697w\"],\n    \"sizes\": \"(max-width: 590px) 100vw, 590px\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    },\n    \"loading\": \"lazy\"\n  }), \"\\n  \"), \"\\n    \"), \"\\n\", mdx(\"em\", {\n    parentName: \"p\"\n  }, mdx(\"code\", {\n    parentName: \"em\",\n    \"className\": \"language-text\"\n  }, \"codesign\"), \" verification of a hardened runtime\")), mdx(\"h2\", null, \"Summary\"), mdx(\"p\", null, \"Apple has recently changed the requirements for applications to install on macOS 10.15 and above. The change requires developers to notarize the application before it gets shipped. Notarization involves submitting the application to Apple to be scanned and generates a JSON report with any issues. More information about notarization can be found \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://developer.apple.com/documentation/security/notarizing_your_app_before_distribution\"\n  }, \"here\"), \".\"), mdx(\"h2\", null, \"What\\u2019s changed?\"), mdx(\"p\", null, \"We have enabled hardened runtime on our macOS binaries which will allow them to be bundled into applications and pass Apple\\u2019s Notarization tests. OpenJDK 11+ will work out of the box, OpenJDK8 needs a bit more work because it\\u2019s built on an older toolchain that the notarization test doesn\\u2019t support. We will be creating a second release of \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://github.com/AdoptOpenJDK/openjdk11-binaries/releases/tag/jdk-11.0.4%2B11\"\n  }, \"jdk-11.0.4+11\"), \" and \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://github.com/AdoptOpenJDK/openjdk12-binaries/releases/tag/jdk-12.0.2%2B10\"\n  }, \"jdk-12.0.2+10\"), \" which will have hardened runtime enabled.\"), mdx(\"h2\", null, \"The issue\"), mdx(\"p\", null, \"We had multiple bug reports from users saying that when they bundle AdoptOpenJDK binaries into their applications, the notarization fails with multiple errors such as the ones below:\"), mdx(\"div\", {\n    \"className\": \"gatsby-highlight\",\n    \"data-language\": \"text\"\n  }, mdx(\"pre\", {\n    parentName: \"div\",\n    \"className\": \"language-text\"\n  }, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-text\"\n  }, \"\\u201Cmessage\\u201D: \\u201CThe signature algorithm used is too weak.\\u201D,\\n\\u201Cmessage\\u201D: \\u201CThe executable does not have the hardened runtime enabled.\\u201D,\"))), mdx(\"p\", null, \"In order to work around this, we have had to enable hardened runtime on our binaries when we codesign them.\"), mdx(\"p\", null, \"This requires us to add \\u2014options runtime to the codesign command. It also requires us to enable the following entitlements:\"), mdx(\"div\", {\n    \"className\": \"gatsby-highlight\",\n    \"data-language\": \"text\"\n  }, mdx(\"pre\", {\n    parentName: \"div\",\n    \"className\": \"language-text\"\n  }, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-text\"\n  }, \"<?xml version=\\\"1.0\\\" encoding=\\\"UTF-8\\\"?><!DOCTYPE plist PUBLIC \\\"-//Apple//DTD PLIST 1.0//EN\\\" \\\"http://www.apple.com/DTDs/PropertyList-1.0.dtd\\\"><plist version=\\\"1.0\\\">\\n<dict>    \\n  <key>com.apple.security.cs.allow-jit</key>\\n  <true/>\\n  <key>com.apple.security.cs.allow-unsigned-executable-memory</key>\\n  <true/>            \\n  <key>com.apple.security.cs.disable-executable-page-protection</key>\\n  <true/>\\n  <key>com.apple.security.cs.allow-dyld-environment-variables</key>\\n  <true/> \\n</dict>\\n</plist>\"))), mdx(\"h3\", null, \"Why can\\u2019t I bundle OpenJDK8?\"), mdx(\"p\", null, \"If you try and bundle our OpenJDK8 binaries you will receive the following notarization failure:\"), mdx(\"div\", {\n    \"className\": \"gatsby-highlight\",\n    \"data-language\": \"text\"\n  }, mdx(\"pre\", {\n    parentName: \"div\",\n    \"className\": \"language-text\"\n  }, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-text\"\n  }, \"\\\"message\\\": \\\"The binary uses an SDK older than the 10.9 SDK.\\\",\"))), mdx(\"p\", null, \"This is because OpenJDK8 is designed to be built on a much older toolchain. We will work closely with the wider community to get a fix that allows OpenJDK8 to be built on a newer version of Xcode. As soon as this is ready we will be able to build an OpenJDK8 hardened runtime enabled binary.\"));\n}\n;\nMDXContent.isMDXComponent = true;","frontmatter":{"title":"Bundling AdoptOpenJDK into a notarized macOS application","author":"georgeadams","date":"July 31, 2019","description":"Some changes have been made to the way we codesign our macOS binaries.","tags":["faq"],"featuredImage":{"childImageSharp":{"sizes":{"base64":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAIAAAA7N+mxAAAACXBIWXMAAAsTAAALEwEAmpwYAAABJ0lEQVQoz42Q/W6CMBTFeROnkW+yIQgTJBZKXRUCTJYIQjKzf3z/R9ixRjOcS/ZLc5Om99xzeqXT8dCd2rbvm6Zt20PX9XVdf/TH7vMLV5z9vtnt6rKoynJwqupdilJKEhYTEsdxmqae52maZui6rmm6YDwZj0ajJ8F4iLThfMPfKKXr9TpJEt/3wzBcLpevAsyazWbz+TwIAtu2FUVRfyBlWYYI51qWnPP0CsahRlGEpptGGSIxxmAIW3QvFgtY+QLLsvCsifCGYfxWnsV5nm+326IoMAWBYXWpiOo4zovAdV3TNGVZvhcnFMYU2yKEwBZ9MIHhrUMWKI+Q8izDzmCOb8MEfQ8TPhYTzlYpI2SFDWOxjuAvq3ux/mxNVXUimF6R/wECfgPuh3ewg6WZ5wAAAABJRU5ErkJggg==","aspectRatio":1.975,"src":"/static/9513b6475928b9e60db2ff40d468acdf/1711c/terminal_codesign.png","srcSet":"/static/9513b6475928b9e60db2ff40d468acdf/b98be/terminal_codesign.png 158w,\n/static/9513b6475928b9e60db2ff40d468acdf/704a2/terminal_codesign.png 315w,\n/static/9513b6475928b9e60db2ff40d468acdf/1711c/terminal_codesign.png 630w,\n/static/9513b6475928b9e60db2ff40d468acdf/dd613/terminal_codesign.png 697w","sizes":"(max-width: 630px) 100vw, 630px"}}}}}},"pageContext":{"slug":"/bundling-adoptopenjdk-into-a-notarized-macos-application/","postPath":"/2019/07/bundling-adoptopenjdk-into-a-notarized-macos-application/","previous":{"fields":{"slug":"/the-first-drop-introducing-adoptopenjdk-quality-assurance-aqa-v1-0/","postPath":"/2019/07/the-first-drop-introducing-adoptopenjdk-quality-assurance-aqa-v1-0/"},"frontmatter":{"title":"The First Drop: Introducing AdoptOpenJDK Quality Assurance (AQA) v1.0","tags":["test","AQA"]}},"next":{"fields":{"slug":"/new-relic-joins-adoptopenjdk-project-to-strengthen-adoption-of-java-technology/","postPath":"/2019/09/new-relic-joins-adoptopenjdk-project-to-strengthen-adoption-of-java-technology/"},"frontmatter":{"title":"New Relic Joins AdoptOpenJDK Project To Strengthen Adoption of Java Technology","tags":["newrelic","openjdk"]}}}},"staticQueryHashes":["1790439409","3142611149","368503166"]}